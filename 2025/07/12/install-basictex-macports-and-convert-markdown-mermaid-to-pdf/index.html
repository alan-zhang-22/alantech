<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/alantech/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/alantech/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/alantech/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/alantech/images/logo.svg" color="#222">

<link rel="stylesheet" href="/alantech/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"alan-zhang-22.github.io","root":"/alantech/","images":"/alantech/images","scheme":"Muse","darkmode":false,"version":"8.23.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"giscus","storage":true,"lazyload":false,"nav":null,"enable":true,"giscus":{"repo":"alan-zhang-22/alantech","repo_id":"R_kgDOPHi3mQ","category":"Blog Comments","category_id":"DIC_kwDOPHi3mc4Cs10y","mapping":"pathname","reactions_enabled":1,"emit_metadata":0,"input_position":"bottom","theme":"preferred_color_scheme","lang":"en"}},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/alantech/js/config.js" defer></script>

    <meta name="description" content="This guide provides step-by-step instructions for installing BasicTeX using MacPorts on a Mac, setting up the environment to process LaTeX documents, and converting a Markdown file containing Mermaid">
<meta property="og:type" content="article">
<meta property="og:title" content="Installing BasicTeX via MacPorts and Converting Markdown with Mermaid Diagrams to PDF on Mac">
<meta property="og:url" content="https://alan-zhang-22.github.io/alantech/2025/07/12/install-basictex-macports-and-convert-markdown-mermaid-to-pdf/index.html">
<meta property="og:site_name" content="Alan Tech">
<meta property="og:description" content="This guide provides step-by-step instructions for installing BasicTeX using MacPorts on a Mac, setting up the environment to process LaTeX documents, and converting a Markdown file containing Mermaid">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-07-12T10:00:00.000Z">
<meta property="article:modified_time" content="2025-07-12T03:19:41.731Z">
<meta property="article:author" content="Alan Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://alan-zhang-22.github.io/alantech/2025/07/12/install-basictex-macports-and-convert-markdown-mermaid-to-pdf/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://alan-zhang-22.github.io/alantech/2025/07/12/install-basictex-macports-and-convert-markdown-mermaid-to-pdf/","path":"2025/07/12/install-basictex-macports-and-convert-markdown-mermaid-to-pdf/","title":"Installing BasicTeX via MacPorts and Converting Markdown with Mermaid Diagrams to PDF on Mac"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Installing BasicTeX via MacPorts and Converting Markdown with Mermaid Diagrams to PDF on Mac | Alan Tech</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/alantech/js/utils.js" defer></script><script src="/alantech/js/motion.js" defer></script><script src="/alantech/js/sidebar.js" defer></script><script src="/alantech/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/alantech/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/alantech/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Alan Tech</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Prerequisites"><span class="nav-number">1.</span> <span class="nav-text">Prerequisites</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Installing-BasicTeX-via-MacPorts"><span class="nav-number">2.</span> <span class="nav-text">Installing BasicTeX via MacPorts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Steps"><span class="nav-number">2.1.</span> <span class="nav-text">Steps</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Converting-Markdown-with-Mermaid-Diagrams-to-PDF"><span class="nav-number">3.</span> <span class="nav-text">Converting Markdown with Mermaid Diagrams to PDF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-by-Step-Process"><span class="nav-number">3.1.</span> <span class="nav-text">Step-by-Step Process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Prepare-the-Markdown-File"><span class="nav-number">3.2.</span> <span class="nav-text">1. Prepare the Markdown File</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Preprocess-Mermaid-Diagrams"><span class="nav-number">3.3.</span> <span class="nav-text">2. Preprocess Mermaid Diagrams</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Convert-to-PDF"><span class="nav-number">3.4.</span> <span class="nav-text">3. Convert to PDF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Verify-Chinese-Font-Support"><span class="nav-number">3.5.</span> <span class="nav-text">4. Verify Chinese Font Support</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshooting"><span class="nav-number">4.</span> <span class="nav-text">Troubleshooting</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Mermaid-Diagram-Not-Rendering"><span class="nav-number">4.1.</span> <span class="nav-text">Mermaid Diagram Not Rendering</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PDF-Issues"><span class="nav-number">4.2.</span> <span class="nav-text">PDF Issues</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Permissions-or-PATH-Issues"><span class="nav-number">4.3.</span> <span class="nav-text">Permissions or PATH Issues</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Missing-LaTeX-Packages"><span class="nav-number">4.4.</span> <span class="nav-text">Missing LaTeX Packages</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Alternative-Manual-Diagram-Rendering"><span class="nav-number">5.</span> <span class="nav-text">Alternative: Manual Diagram Rendering</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Notes"><span class="nav-number">6.</span> <span class="nav-text">Notes</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Alan Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/alantech/archives/">
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://alan-zhang-22.github.io/alantech/2025/07/12/install-basictex-macports-and-convert-markdown-mermaid-to-pdf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/alantech/images/avatar.gif">
      <meta itemprop="name" content="Alan Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alan Tech">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Installing BasicTeX via MacPorts and Converting Markdown with Mermaid Diagrams to PDF on Mac | Alan Tech">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Installing BasicTeX via MacPorts and Converting Markdown with Mermaid Diagrams to PDF on Mac
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-07-12 10:00:00 / Modified: 03:19:41" itemprop="dateCreated datePublished" datetime="2025-07-12T10:00:00+00:00">2025-07-12</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>This guide provides step-by-step instructions for installing BasicTeX using MacPorts on a Mac, setting up the environment to process LaTeX documents, and converting a Markdown file containing Mermaid diagrams into a PDF with diagrams rendered as images. The process uses MacPorts to install BasicTeX, <code>mmdc</code> (Mermaid CLI) to preprocess Mermaid diagrams into images, and Pandoc with <code>xelatex</code> to generate the PDF. It includes setup, execution, and troubleshooting steps to ensure a smooth workflow.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><p>Before proceeding, ensure you have the following tools and configurations:</p>
<ol>
<li><p><strong>MacPorts</strong>: A package manager for installing open-source software on macOS.</p>
<ul>
<li>If not installed, download and install from <a target="_blank" rel="noopener" href="https://www.macports.org/install.php">MacPorts.org</a>.</li>
<li>Verify installation:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">port version</span><br></pre></td></tr></table></figure>
Expected output: Version number (e.g., 2.10.1).</li>
<li>Update MacPorts:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port selfupdate</span><br><span class="line"><span class="built_in">sudo</span> port upgrade outdated</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>Node.js and npm</strong>: Required for Mermaid CLI.</p>
<ul>
<li>Install via MacPorts:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port install nodejs20</span><br></pre></td></tr></table></figure>
<ul>
<li>Note: <code>nodejs20</code> is a recent version at the time of writing (July 2025). Check for newer versions with <code>port search nodejs</code>.</li>
</ul>
</li>
<li>Verify:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node --version</span><br><span class="line">npm --version</span><br></pre></td></tr></table></figure>
Expected: Node.js v16 or higher (e.g., v20.x.x), npm v8 or higher (e.g., v10.x.x).</li>
</ul>
</li>
<li><p><strong>Mermaid CLI</strong>: Renders Mermaid diagrams to images.</p>
<ul>
<li>Install globally via npm:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> npm install -g @mermaid-js/mermaid-cli</span><br></pre></td></tr></table></figure></li>
<li>Verify:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mmdc --version</span><br></pre></td></tr></table></figure>
Expected: Version 11.6.0 or similar.</li>
</ul>
</li>
<li><p><strong>Pandoc</strong>: Converts Markdown to PDF.</p>
<ul>
<li>Install via MacPorts:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port install pandoc</span><br></pre></td></tr></table></figure></li>
<li>Verify:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandoc --version</span><br></pre></td></tr></table></figure>
Expected: Version 3.7.0.2 or higher.</li>
</ul>
</li>
</ol>
<h2 id="Installing-BasicTeX-via-MacPorts"><a href="#Installing-BasicTeX-via-MacPorts" class="headerlink" title="Installing BasicTeX via MacPorts"></a>Installing BasicTeX via MacPorts</h2><p>BasicTeX is a compact TeX distribution, ideal for users who need LaTeX (including <code>xelatex</code> for PDF generation) without the larger MacTeX package. MacPorts provides a <code>texlive-basic</code> port that serves as an equivalent to BasicTeX.</p>
<h3 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h3><ol>
<li><p><strong>Install <code>texlive-basic</code></strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port install texlive-basic</span><br></pre></td></tr></table></figure>
<ul>
<li>This installs a minimal TeX distribution, including <code>xelatex</code>, to <code>/opt/local/bin</code>.</li>
<li>Installation size is approximately 100–200 MB, much smaller than MacTeX (~8 GB).<a target="_blank" rel="noopener" href="https://tex.stackexchange.com/questions/97183/what-are-the-practical-differences-between-installing-latex-from-mactex-or-macpo"></a></li>
</ul>
</li>
<li><p><strong>Install Additional Fonts</strong>:<br>For Chinese text support (e.g., <code>PingFang SC</code> or <code>Songti SC</code>), install recommended fonts:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port install texlive-fonts-recommended</span><br></pre></td></tr></table></figure>
<ul>
<li>This ensures fonts for multilingual documents are available.</li>
</ul>
</li>
<li><p><strong>Verify Installation</strong>:<br>Check that <code>xelatex</code> is installed:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xelatex --version</span><br></pre></td></tr></table></figure>
<p>Expected: Output like <code>XeTeX 3.141592653-2.6-0.999997 (TeX Live 2025)</code>.</p>
</li>
<li><p><strong>Update PATH</strong>:<br>MacPorts installs binaries to <code>/opt/local/bin</code>. Ensure this is in your PATH:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<p>If <code>/opt/local/bin</code> is missing, add it to <code>~/.zshrc</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=/opt/local/bin:$PATH&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>Verify:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> xelatex</span><br></pre></td></tr></table></figure>
<p>Expected: <code>/opt/local/bin/xelatex</code>.</p>
</li>
</ol>
<h2 id="Converting-Markdown-with-Mermaid-Diagrams-to-PDF"><a href="#Converting-Markdown-with-Mermaid-Diagrams-to-PDF" class="headerlink" title="Converting Markdown with Mermaid Diagrams to PDF"></a>Converting Markdown with Mermaid Diagrams to PDF</h2><p>To convert a Markdown file with Mermaid diagrams (e.g., <code>input.md</code>) to a PDF with diagrams rendered as images, use <code>mmdc</code> to preprocess the diagrams into images and Pandoc with <code>xelatex</code> to generate the PDF.</p>
<h3 id="Step-by-Step-Process"><a href="#Step-by-Step-Process" class="headerlink" title="Step-by-Step Process"></a>Step-by-Step Process</h3><h3 id="1-Prepare-the-Markdown-File"><a href="#1-Prepare-the-Markdown-File" class="headerlink" title="1. Prepare the Markdown File"></a>1. Prepare the Markdown File</h3><p>Create or verify your Markdown file (e.g., <code>input.md</code>) with a Mermaid diagram. Ensure proper Mermaid syntax with node labels and line breaks.</p>
<p>Example <code>input.md</code>:</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">mainfont: &quot;PingFang SC&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="section"># Test Document</span></span><br><span class="line"></span><br><span class="line"><span class="code">```mermaid</span></span><br><span class="line"><span class="code">graph TD</span></span><br><span class="line"><span class="code">    A[Start] --&gt; B[Process]</span></span><br><span class="line"><span class="code">    B --&gt; C[End]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- Use triple backticks with `mermaid` (`` ```mermaid ``).</span><br><span class="line">- Define nodes with labels (e.g., `A[Start]`) and separate statements with line breaks to avoid parse errors.</span><br><span class="line">- For Chinese text, specify a font like `PingFang SC` or `Songti SC` in the YAML header.</span><br><span class="line">- Save in your working directory (e.g., `~/workspace`):</span><br><span class="line">  ```bash</span><br><span class="line">  cd ~/workspace</span><br><span class="line">  cat input.md</span><br></pre></td></tr></table></figure>

<h3 id="2-Preprocess-Mermaid-Diagrams"><a href="#2-Preprocess-Mermaid-Diagrams" class="headerlink" title="2. Preprocess Mermaid Diagrams"></a>2. Preprocess Mermaid Diagrams</h3><p>Use <code>mmdc</code> to convert Mermaid code blocks into image references (PNG or SVG) in a new Markdown file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mmdc -i input.md -o output-with-images.md -e png --theme neutral</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-e png</code>: Outputs PNG images (use <code>-e svg</code> for vector images if preferred).</li>
<li><code>--theme neutral</code>: Ensures consistent diagram styling.</li>
<li>Images (e.g., <code>mermaid-image-0.png</code>) are saved in <code>~/workspace</code>.</li>
</ul>
<p>Verify the output:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> output-with-images.md</span><br><span class="line"><span class="built_in">ls</span> *.png</span><br><span class="line">open mermaid-image-0.png</span><br></pre></td></tr></table></figure>
<p>Expected <code>output-with-images.md</code>:</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">mainfont: &quot;PingFang SC&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="section"># Test Document</span></span><br><span class="line"></span><br><span class="line">![](<span class="link">mermaid-image-0.png</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-Convert-to-PDF"><a href="#3-Convert-to-PDF" class="headerlink" title="3. Convert to PDF"></a>3. Convert to PDF</h3><p>Convert the processed Markdown to PDF using Pandoc and <code>xelatex</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandoc output-with-images.md -o output.pdf --pdf-engine=xelatex</span><br></pre></td></tr></table></figure>
<ul>
<li>Ensure <code>mermaid-image-0.png</code> is in <code>~/workspace</code>.</li>
<li>The <code>--pdf-engine=xelatex</code> flag supports Chinese fonts via the <code>mainfont</code> setting.</li>
</ul>
<p>Verify the PDF:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open output.pdf</span><br></pre></td></tr></table></figure>
<p>The Mermaid diagram should appear as an image, not text.</p>
<h3 id="4-Verify-Chinese-Font-Support"><a href="#4-Verify-Chinese-Font-Support" class="headerlink" title="4. Verify Chinese Font Support"></a>4. Verify Chinese Font Support</h3><p>If Chinese text is garbled, confirm the font is available:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fc-list :lang=zh | grep PingFang</span><br></pre></td></tr></table></figure>
<p>If <code>PingFang SC</code> is missing, use <code>Songti SC</code> or another font:</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">mainfont: &quot;Songti SC&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure>
<p>Update <code>input.md</code> and repeat steps 2–3. Alternatively, install additional fonts:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port install texlive-fonts-extra</span><br></pre></td></tr></table></figure>

<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Mermaid-Diagram-Not-Rendering"><a href="#Mermaid-Diagram-Not-Rendering" class="headerlink" title="Mermaid Diagram Not Rendering"></a>Mermaid Diagram Not Rendering</h3><p>If <code>output-with-images.md</code> contains raw Mermaid code:</p>
<ul>
<li><strong>Check Syntax</strong>: Ensure nodes are defined (e.g., <code>A[Start] --&gt; B[Process]</code>) with line breaks. Test in the <a target="_blank" rel="noopener" href="https://mermaid.live/">Mermaid Live Editor</a>.</li>
<li><strong>Verbose Mode</strong>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mmdc -i input.md -o output-with-images.md -e png --theme neutral --verbose</span><br></pre></td></tr></table></figure>
Look for parse errors (e.g., <code>Expecting &#39;NEWLINE&#39;, got &#39;NODE_STRING&#39;</code>).</li>
<li><strong>Puppeteer Config</strong>: If rendering fails, create <code>puppeteer.json</code> in <code>~/workspace</code>:<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;headless&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;timeout&quot;</span><span class="punctuation">:</span> <span class="number">60000</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
Run:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mmdc -i input.md -o output-with-images.md -e png --puppeteerConfigFile puppeteer.json</span><br></pre></td></tr></table></figure></li>
<li><strong>Downgrade <code>mmdc</code></strong>: If version 11.6.0 fails, try an older version:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> npm uninstall -g @mermaid-js/mermaid-cli</span><br><span class="line"><span class="built_in">sudo</span> npm install -g @mermaid-js/mermaid-cli@10.9.1</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="PDF-Issues"><a href="#PDF-Issues" class="headerlink" title="PDF Issues"></a>PDF Issues</h3><p>If the PDF is blank or missing the diagram:</p>
<ul>
<li>Verify <code>mermaid-image-0.png</code> exists:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> ~/workspace/*.png</span><br></pre></td></tr></table></figure></li>
<li>Run Pandoc with verbose output:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandoc output-with-images.md -o output.pdf --pdf-engine=xelatex --verbose</span><br></pre></td></tr></table></figure></li>
<li>Ensure <code>xelatex</code> is accessible:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> xelatex</span><br></pre></td></tr></table></figure>
If missing, reinstall:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port install texlive-basic</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Permissions-or-PATH-Issues"><a href="#Permissions-or-PATH-Issues" class="headerlink" title="Permissions or PATH Issues"></a>Permissions or PATH Issues</h3><p>If <code>mmdc</code>, <code>pandoc</code>, or <code>xelatex</code> are not found:</p>
<ul>
<li>Verify <code>/opt/local/bin</code> is in PATH:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=/opt/local/bin:$PATH&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure></li>
<li>Check permissions:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /opt/local/bin/mmdc /opt/local/bin/xelatex /opt/local/bin/pandoc</span><br><span class="line"><span class="built_in">chmod</span> u+x /opt/local/bin/mmdc /opt/local/bin/xelatex /opt/local/bin/pandoc</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Missing-LaTeX-Packages"><a href="#Missing-LaTeX-Packages" class="headerlink" title="Missing LaTeX Packages"></a>Missing LaTeX Packages</h3><p>If Pandoc reports missing packages (e.g., <code>fontspec.sty</code>):</p>
<ul>
<li>Install via <code>tlmgr</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> tlmgr install fontspec</span><br></pre></td></tr></table></figure></li>
<li>Update <code>tlmgr</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> tlmgr update --self --all</span><br></pre></td></tr></table></figure></li>
<li>Set a closer repository for faster downloads:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> tlmgr option repository http://ftp.yzu.edu.tw/CTAN/systems/texlive/tlnet</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Alternative-Manual-Diagram-Rendering"><a href="#Alternative-Manual-Diagram-Rendering" class="headerlink" title="Alternative: Manual Diagram Rendering"></a>Alternative: Manual Diagram Rendering</h2><p>If <code>mmdc</code> fails to process Markdown:</p>
<ol>
<li>Extract Mermaid code to <code>diagram.mmd</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&#x27;graph TD\n    A[Start] --&gt; B[Process]\n    B --&gt; C[End]&#x27;</span> &gt; diagram.mmd</span><br></pre></td></tr></table></figure></li>
<li>Render to PNG:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mmdc -i diagram.mmd -o diagram.png --theme neutral</span><br><span class="line">open diagram.png</span><br></pre></td></tr></table></figure></li>
<li>Create <code>manual.md</code>:<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="section">mainfont: &quot;PingFang SC&quot;</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"><span class="section"># Test Document</span></span><br><span class="line"></span><br><span class="line">![](<span class="link">diagram.png</span>)</span><br></pre></td></tr></table></figure></li>
<li>Convert to PDF:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pandoc manual.md -o output.pdf --pdf-engine=xelatex</span><br><span class="line">open output.pdf</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><ul>
<li><strong>Why MacPorts?</strong>: MacPorts allows fine-grained control over TeX packages, saving disk space compared to MacTeX (~15 GB vs. ~1–2 GB for <code>texlive-basic</code>). It integrates well with other MacPorts packages and is ideal for command-line users.<a target="_blank" rel="noopener" href="https://tex.stackexchange.com/questions/97183/what-are-the-practical-differences-between-installing-latex-from-mactex-or-macpo"></a></li>
<li><strong>Mermaid Syntax</strong>: Always use node labels (e.g., <code>A[Text]</code>) and line breaks to avoid parse errors in <code>mmdc</code>.</li>
<li><strong>Font Support</strong>: Install <code>texlive-fonts-recommended</code> or <code>texlive-fonts-extra</code> for robust multilingual support.</li>
<li><strong>Updates</strong>: Keep tools updated:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> port selfupdate</span><br><span class="line"><span class="built_in">sudo</span> port upgrade outdated</span><br><span class="line"><span class="built_in">sudo</span> npm install -g @mermaid-js/mermaid-cli</span><br><span class="line"><span class="built_in">sudo</span> tlmgr update --all</span><br></pre></td></tr></table></figure></li>
<li><strong>Resources</strong>: Use the <a target="_blank" rel="noopener" href="https://mermaid.live/">Mermaid Live Editor</a> to test diagrams and <a target="_blank" rel="noopener" href="https://tex.stackexchange.com/">TeX Stack Exchange</a> for LaTeX issues.</li>
</ul>
<p>This guide ensures you can install BasicTeX via MacPorts and convert Markdown files with Mermaid diagrams to PDFs with diagrams rendered as images. If issues arise, share error outputs and tool versions (<code>port version</code>, <code>mmdc --version</code>, <code>pandoc --version</code>, <code>xelatex --version</code>) for further assistance.</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/alantech/2025/07/12/Emacs_C++_IDE_Setup_Eglot/" rel="prev" title="Turning Emacs into a Modern C++ IDE on macOS: A Comprehensive Configuration Guide (Eglot Edition)">
                  <i class="fa fa-angle-left"></i> Turning Emacs into a Modern C++ IDE on macOS: A Comprehensive Configuration Guide (Eglot Edition)
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Alan Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
